"use strict";(self.webpackChunkstaticdocs_starter=self.webpackChunkstaticdocs_starter||[]).push([[1029],{3905:function(e,n,t){t.r(n),t.d(n,{MDXContext:function(){return p},MDXProvider:function(){return m},mdx:function(){return h},useMDXComponents:function(){return u},withMDXComponents:function(){return s}});var a=t(67294);function i(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(){return r=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},r.apply(this,arguments)}function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function l(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(Object(t),!0).forEach((function(n){i(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function c(e,n){if(null==e)return{};var t,a,i=function(e,n){if(null==e)return{};var t,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||(i[t]=e[t]);return i}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}var p=a.createContext({}),s=function(e){return function(n){var t=u(n.components);return a.createElement(e,r({},n,{components:t}))}},u=function(e){var n=a.useContext(p),t=n;return e&&(t="function"==typeof e?e(n):l(l({},n),e)),t},m=function(e){var n=u(e.components);return a.createElement(p.Provider,{value:n},e.children)},d={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},f=a.forwardRef((function(e,n){var t=e.components,i=e.mdxType,r=e.originalType,o=e.parentName,p=c(e,["components","mdxType","originalType","parentName"]),s=u(t),m=i,f=s["".concat(o,".").concat(m)]||s[m]||d[m]||r;return t?a.createElement(f,l(l({ref:n},p),{},{components:t})):a.createElement(f,l({ref:n},p))}));function h(e,n){var t=arguments,i=n&&n.mdxType;if("string"==typeof e||i){var r=t.length,o=new Array(r);o[0]=f;var l={};for(var c in n)hasOwnProperty.call(n,c)&&(l[c]=n[c]);l.originalType=e,l.mdxType="string"==typeof e?e:i,o[1]=l;for(var p=2;p<r;p++)o[p]=t[p];return a.createElement.apply(null,o)}return a.createElement.apply(null,t)}f.displayName="MDXCreateElement"},25438:function(e,n,t){t.r(n),t.d(n,{assets:function(){return s},contentTitle:function(){return c},default:function(){return d},frontMatter:function(){return l},metadata:function(){return p},toc:function(){return u}});var a=t(83117),i=t(80102),r=(t(67294),t(3905)),o=["components"],l={title:"C++ Client",category:"Invocation",sidebar_position:5},c=void 0,p={unversionedId:"cppclient",id:"cppclient",title:"C++ Client",description:"Since 4.8.",source:"@site/docs/cppclient.md",sourceDirName:".",slug:"/cppclient",permalink:"/watchman/docs/cppclient",draft:!1,editUrl:"https://github.com/facebook/watchman/tree/main/website/docs/cppclient.md",tags:[],version:"current",sidebarPosition:5,frontMatter:{title:"C++ Client",category:"Invocation",sidebar_position:5},sidebar:"tutorialSidebar",previous:{title:"watchman-replicate-subscription",permalink:"/watchman/docs/watchman-replicate-subscription"},next:{title:"NodeJS",permalink:"/watchman/docs/nodejs"}},s={},u=[{value:"Installation",id:"installation",level:2},{value:"API",id:"api",level:2},{value:"Using the C++ client in your application&#39;s build",id:"using-the-c-client-in-your-applications-build",level:2}],m={toc:u};function d(e){var n=e.components,t=(0,i.Z)(e,o);return(0,r.mdx)("wrapper",(0,a.Z)({},m,t,{components:n,mdxType:"MDXLayout"}),(0,r.mdx)("p",null,(0,r.mdx)("em",{parentName:"p"},"Since 4.8.")),(0,r.mdx)("p",null,"Watchman includes a C++ client library to facilitate easy access to Watchman\ndata from C++ applications. This library provides APIs for:"),(0,r.mdx)("ul",null,(0,r.mdx)("li",{parentName:"ul"},"Opening and maintaining a connection to a local Watchman server."),(0,r.mdx)("li",{parentName:"ul"},"Executing request-response Watchman commands."),(0,r.mdx)("li",{parentName:"ul"},"Subscribing to updates with in directory trees.")),(0,r.mdx)("h2",{id:"installation"},"Installation"),(0,r.mdx)("p",null,"Provided the Folly library is present when Watchman is built, the C++ client\nlibrary is automatically built and installed. For details on building Watchman\nsee ",(0,r.mdx)("a",{parentName:"p",href:"/watchman/docs/install"},"Installation"),"."),(0,r.mdx)("h2",{id:"api"},"API"),(0,r.mdx)("p",null,"The public Watchman C++ client API is entirely covered in the installed\n",(0,r.mdx)("inlineCode",{parentName:"p"},"watchman/WatchmanClient.h")," header file. This header contains a usage synopsis\nand notes on the public API features."),(0,r.mdx)("p",null,"For a simple example of API usage, sending simple request-response commands to\nWatchman, see ",(0,r.mdx)("inlineCode",{parentName:"p"},"cppclient/CLI.cpp")," in the Watchman source tree. For a more\nextensive example of the API including use of subscriptions, see the integration\ntest ",(0,r.mdx)("inlineCode",{parentName:"p"},"integration/cppclient.cpp")," also in the Watchman source."),(0,r.mdx)("p",null,"The C++ client library and its API make heavy use of the Folly library and as\nsuch familiarity with this is highly recommended. Specifically, the client\nlibrary makes extensive use of\n",(0,r.mdx)("a",{parentName:"p",href:"https://github.com/facebook/folly/blob/master/folly/io/async/README.md"},"Folly's async features"),"\nto provide high-performance asynchronous I/O, and\n",(0,r.mdx)("a",{parentName:"p",href:"https://github.com/facebook/folly/blob/master/folly/docs/Dynamic.md"},"Folly's dynamics"),"\nto avoid needing to construct/process raw JSON in C++."),(0,r.mdx)("h2",{id:"using-the-c-client-in-your-applications-build"},"Using the C++ client in your application's build"),(0,r.mdx)("p",null,"To facilitate integration into your application's build, the Watchman C++ client\nlibrary provides support for\n",(0,r.mdx)("a",{parentName:"p",href:"https://www.freedesktop.org/wiki/Software/pkg-config/"},"pkg-config"),"."),(0,r.mdx)("p",null,"For example, if your application was contained entirely in one C++ file called\n",(0,r.mdx)("inlineCode",{parentName:"p"},"app.cpp")," the following would be sufficient for build on a system with GNU Make:"),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre",className:"language-bash"},"$ make LDFLAGS=$(pkg-config watchmanclient --libs) CPPFLAGS=$(pkg-config watchmanclient --cflags) app\n")),(0,r.mdx)("p",null,"If Watchman is installed in a location ",(0,r.mdx)("inlineCode",{parentName:"p"},"pkg-config")," does not search for packages\nby default, you may need to modify the ",(0,r.mdx)("inlineCode",{parentName:"p"},"PKG_CONFIG_PATH")," environment variable.\nFor example:"),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre",className:"language-bash"},"$ export PKG_CONFIG_PATH=<watchman path>/lib/pkgconfig:$PKG_CONFIG_PATH\n")))}d.isMDXComponent=!0}}]);