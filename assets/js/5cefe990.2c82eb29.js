"use strict";(self.webpackChunkstaticdocs_starter=self.webpackChunkstaticdocs_starter||[]).push([[1040],{3905:function(e,t,n){n.r(t),n.d(t,{MDXContext:function(){return l},MDXProvider:function(){return p},mdx:function(){return h},useMDXComponents:function(){return m},withMDXComponents:function(){return u}});var r=n(67294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(){return a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a.apply(this,arguments)}function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var l=r.createContext({}),u=function(e){return function(t){var n=m(t.components);return r.createElement(e,a({},t,{components:n}))}},m=function(e){var t=r.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},p=function(e){var t=m(e.components);return r.createElement(l.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},f=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,a=e.originalType,c=e.parentName,l=s(e,["components","mdxType","originalType","parentName"]),u=m(n),p=o,f=u["".concat(c,".").concat(p)]||u[p]||d[p]||a;return n?r.createElement(f,i(i({ref:t},l),{},{components:n})):r.createElement(f,i({ref:t},l))}));function h(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=n.length,c=new Array(a);c[0]=f;var i={};for(var s in t)hasOwnProperty.call(t,s)&&(i[s]=t[s]);i.originalType=e,i.mdxType="string"==typeof e?e:o,c[1]=i;for(var l=2;l<a;l++)c[l]=n[l];return r.createElement.apply(null,c)}return r.createElement.apply(null,n)}f.displayName="MDXCreateElement"},59387:function(e,t,n){n.r(t),n.d(t,{assets:function(){return u},contentTitle:function(){return s},default:function(){return d},frontMatter:function(){return i},metadata:function(){return l},toc:function(){return m}});var r=n(83117),o=n(80102),a=(n(67294),n(3905)),c=["components"],i={title:"Clockspec",category:"Queries"},s=void 0,l={unversionedId:"clockspec",id:"clockspec",title:"Clockspec",description:"For commands that query based on time, watchman offers a couple of different",source:"@site/docs/clockspec.md",sourceDirName:".",slug:"/clockspec",permalink:"/watchman/docs/clockspec",draft:!1,editUrl:"https://github.com/facebook/watchman/tree/main/website/docs/clockspec.md",tags:[],version:"current",frontMatter:{title:"Clockspec",category:"Queries"},sidebar:"tutorialSidebar",previous:{title:"watch",permalink:"/watchman/docs/cmd/watch"},next:{title:"File Queries",permalink:"/watchman/docs/file-query"}},u={},m=[],p={toc:m};function d(e){var t=e.components,n=(0,o.Z)(e,c);return(0,a.mdx)("wrapper",(0,r.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,a.mdx)("p",null,"For commands that query based on time, watchman offers a couple of different\nways to measure time."),(0,a.mdx)("ul",null,(0,a.mdx)("li",{parentName:"ul"},"number of seconds since the unix epoch (unix ",(0,a.mdx)("inlineCode",{parentName:"li"},"time_t")," style)"),(0,a.mdx)("li",{parentName:"ul"},"a clock id of the form ",(0,a.mdx)("inlineCode",{parentName:"li"},"c:123:234")),(0,a.mdx)("li",{parentName:"ul"},"a named cursor of the form ",(0,a.mdx)("inlineCode",{parentName:"li"},"n:whatever")," (but clock ids are faster!)")),(0,a.mdx)("p",null,"The first and most obvious is passing a unix timestamp. Watchman records the\nobserved time that files change and allows you to find files that have changed\nsince that time. Using a timestamp is prone to race conditions in understanding\nthe complete state of the file tree."),(0,a.mdx)("p",null,"Using an abstract clock id insulates the client from these race conditions by\nticking as changes are detected rather than as time moves. Watchman returns the\ncurrent clock id when it delivers match results; you can use that value as the\nclockspec in your next time relative query to get a race free assessment of\nchanged files."),(0,a.mdx)("p",null,'As a convenience, watchman can maintain the last observed clock for a client by\nassociating it with a client defined cursor name. For example, you could\nenumerate all the "C" source files on your first invocation of:'),(0,a.mdx)("pre",null,(0,a.mdx)("code",{parentName:"pre",className:"language-bash"},"watchman since /path/to/src n:c_srcs '*.c'\n")),(0,a.mdx)("p",null,'and when you run it a second time, it will show you only the "C" source files\nthat changed since the last time that someone queried using "n:c_srcs" as the\nclock spec. However, it\'s not possible to "roll back" a named cursor, so\nadvanced users desiring such functionality should use clock ids instead.'),(0,a.mdx)("p",null,(0,a.mdx)("em",{parentName:"p"},"Since 4.7.")),(0,a.mdx)("p",null,"We recommend not using the ",(0,a.mdx)("inlineCode",{parentName:"p"},"n:whatever")," form as it requires an exclusive lock on\nthe view to execute; this can increase contention and result in slower queries."))}d.isMDXComponent=!0}}]);